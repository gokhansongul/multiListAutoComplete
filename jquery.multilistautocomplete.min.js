(function(g){g.fn.multiListAutoComplete=function(f){if(!f||f.proxy&&"function"!==typeof f.proxy||!f.appendTo)throw"Error!";var h=g(this),e=null,m=[],j=0,n=0,r=function(){b.onOpen&&b.onOpen(j);e.fadeIn(b.delayTime);b.visibleTime&&(n=setTimeout(function(){k()},b.visibleTime))},k=function(){e.fadeOut(b.delayTime,b.onClose)},l=function(){return e.find("ul.autocomplete").find("li").filter(".state-hover")},p=function(a){var c=null,c=a&&a.length?a:l();return c.parents("ul.autocomplete")},q=function(a){l().removeClass("state-hover");
    a.addClass("state-hover")},s=function(a){if(!a||!a.length)a=p();var c=a.next("ul.autocomplete");c.length||(c=a.parent().find("ul.autocomplete").first());return c},t=function(a){if(!a||!a.length)a=p();var c=a.prev("ul.autocomplete");c.length||(c=a.parent().find("ul.autocomplete").last());return c},v=function(a){e.is(":visible")||r();a.length?(a=a.next(),a.length||(a=s().find("li").first())):a=e.find("ul.autocomplete").find("li").first();q(a)},w=function(a){a=a.prev();a.length||(a=t().find("li").last());
    q(a)},u=function(a,c){if(a&&a.length){var b=p(a),d=null,b=d=39==c.keyCode?s(b):t(b),d=a.index(),d=b.find("li").eq(d);if(!d||!d.length)d=b.find("li").eq(0);q(d)}},x=function(a){b.visibleTime&&clearTimeout(n);var c=a.keyCode,e={38:w,40:v,39:u,37:u};e[c]&&(h.focus(),e[c](l(),a),b.onFocus&&b.onFocus.call(this,l().find("a")),b.visibleTime&&(n=setTimeout(function(){k()},b.visibleTime)))},b={delayTime:500,visibleTime:0,minLength:3,itemPerList:10,eventType:"keyup",appendTo:null,label:null,value:null,proxy:null,
    renderItem:function(a,b){var e=g("<li></li>").addClass("autocomplete-search-item"),d=g("<a></a>").appendTo(e);d.data("value",a[b.value]).data("label",a[b.label]).html(a[b.label]).bind("click",function(){h.val(a[b.value]).focus();b.onSelect&&b.onSelect.call(this,d)});return e},onSelect:function(){},onFocus:function(a){a.data("value")&&h.val(a.data("value")).focus()},onOpen:function(){},onClose:function(){},onEnter:function(){}};g.extend(b,f);e=g(b.appendTo);h.bind(b.eventType,function(a){for(var c=
    0;c<m.length;c++)clearTimeout(m[c]);this.setAttribute("autocomplete","off");var c=g.trim(this.value),f=a.keyCode,d=c&&c.length;-1!=b.eventType.toLowerCase().indexOf("keydown")&&(8!=a.keyCode?d++:d--);13==f&&b.onEnter&&b.onEnter(c,b);if(d>=b.minLength){if(37<=f&&40>=f)return x(a),!1;a=setTimeout(function(){b.proxy(h.val(),function(a){if(a&&a.list){e.find("ul.autocomplete").remove();for(var c in a.list){j++;var d=a.list[c];if(d&&g.isArray(d))for(var f=g("<ul></ul>").addClass("autocomplete").addClass("list-"+
    j).appendTo(b.appendTo),h=0;h<d.length;h++)f.append(b.renderItem(d[h],b))}1<j?e.addClass("multipleList"):e.removeClass("multipleList");r()}});j=0},b.delayTime);m.push(a)}else k(),e.find("ul.autocomplete").remove()}).bind("blur",k)}})(jQuery);