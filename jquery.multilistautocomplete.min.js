(function(h){h.fn.multiListAutoComplete=function(f){if(!f||f.proxy&&"function"!==typeof f.proxy||!f.appendTo)throw"Error!";var g=h(this),e=null,m=[],j=0,n=0,r=function(){b.onOpen&&b.onOpen(j);e.fadeIn(b.delayTime);b.visibleTime&&(n=setTimeout(function(){k()},b.visibleTime))},k=function(){e.fadeOut(b.delayTime,b.onClose)},l=function(){return e.find("ul.autocomplete").find("li").filter(".state-hover")},p=function(a){var c=null,c=a&&a.length?a:l();return c.parents("ul.autocomplete")},q=function(a){l().removeClass("state-hover");
    a.addClass("state-hover")},s=function(a){if(!a||!a.length)a=p();var c=a.next("ul.autocomplete");c.length||(c=a.parent().find("ul.autocomplete").first());return c},t=function(a){if(!a||!a.length)a=p();var c=a.prev("ul.autocomplete");c.length||(c=a.parent().find("ul.autocomplete").last());return c},v=function(a){e.is(":visible")||r();a.length?(a=a.next(),a.length||(a=s().find("li").first())):a=e.find("ul.autocomplete").find("li").first();q(a)},w=function(a){a=a.prev();a.length||(a=t().find("li").last());
    q(a)},u=function(a,c){var b=p(a),d=null,b=d=39==c.keyCode?s(b):t(b),d=a.index(),d=b.find("li").eq(d);if(!d||!d.length)d=b.find("li").eq(0);q(d)},x=function(a){var c=a.find("a").data("value");c&&(g.val(c).focus(),b.onSelect&&b.onSelect.call(this,a.find("a")),k())},y=function(a){b.visibleTime&&clearTimeout(n);var c=a.keyCode,e={38:w,40:v,39:u,37:u,13:x};e[c]&&(g.focus(),e[c](l(),a),b.onFocus&&b.onFocus.call(this,l().find("a")),b.visibleTime&&(n=setTimeout(function(){k()},b.visibleTime)))},b={delayTime:500,
    visibleTime:0,minLength:3,itemPerList:10,eventType:"keyup",appendTo:null,label:null,value:null,proxy:null,renderItem:function(a,c){var b=h("<li></li>").addClass("autocomplete-search-item"),d=h("<a></a>").appendTo(b);d.data("value",a[c.value]).data("label",a[c.label]).html(a[c.label]).bind("click",function(){g.val(a[c.value]).focus();c.onSelect&&c.onSelect.call(this,d)});return b},onSelect:function(){},onFocus:function(a){g.val(a.data("value")).focus()},onOpen:function(){},onClose:function(){}};h.extend(b,
    f);e=h(b.appendTo);g.bind(b.eventType,function(a){for(var c=0;c<m.length;c++)clearTimeout(m[c]);this.setAttribute("autocomplete","off");var c=h.trim(this.value),f=a.keyCode,d=b.minLength;"keydown"==b.eventType.toLowerCase()&&(d-=2,8==a.keyCode&&(d=b.minLength+1));if(c&&c.length>=d){if(37<=f&&40>=f||13==f)return y(a),!1;a=setTimeout(function(){b.proxy(g.val(),function(a){if(a&&a.list){e.find("ul.autocomplete").remove();for(var c in a.list){j++;var d=a.list[c];if(d&&h.isArray(d))for(var f=h("<ul></ul>").addClass("autocomplete").addClass("list-"+
    j).appendTo(b.appendTo),g=0;g<d.length;g++)f.append(b.renderItem(d[g],b))}1<j?e.addClass("multipleList"):e.removeClass("multipleList");r()}});j=0},b.delayTime);m.push(a)}else k(),e.find("ul.autocomplete").remove()}).bind("blur",k)}})(jQuery);