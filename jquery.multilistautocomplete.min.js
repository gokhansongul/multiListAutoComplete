(function(g){g.fn.multiListAutoComplete=function(h){if(!h||h.proxy&&"function"!==typeof h.proxy||!h.appendTo)throw"Error!";var j=g(this),f=null,n=[],k=0,p=0,s=function(){c.onOpen&&c.onOpen(k);f.fadeIn(c.delayTime);c.visibleTime&&(p=setTimeout(function(){l()},c.visibleTime))},l=function(){f.fadeOut(c.delayTime,c.onClose)},m=function(){return f.find("ul.autocomplete").find("li").filter(".state-hover")},q=function(a){var b=null,b=a&&a.length?a:m();return b.parents("ul.autocomplete")},r=function(a){m().removeClass("state-hover");
    a.addClass("state-hover")},t=function(a){if(!a||!a.length)a=q();var b=a.next("ul.autocomplete");b.length||(b=a.parent().find("ul.autocomplete").first());return b},u=function(a){if(!a||!a.length)a=q();var b=a.prev("ul.autocomplete");b.length||(b=a.parent().find("ul.autocomplete").last());return b},w=function(a){f.is(":visible")||s();a.length?(a=a.next(),a.length||(a=t().find("li").first())):a=f.find("ul.autocomplete").find("li").first();r(a)},x=function(a){a=a.prev();a.length||(a=u().find("li").last());
    r(a)},v=function(a,b){var c=q(a),e=null,c=e=39==b.keyCode?t(c):u(c),e=a.index(),e=c.find("li").eq(e);if(!e||!e.length)e=c.find("li").eq(0);r(e)},y=function(a){var b=a.find("a").data("value");b&&(j.val(b).focus(),c.onSelect&&c.onSelect.call(this,a.find("a")),l())},z=function(a){c.visibleTime&&clearTimeout(p);var b=a.keyCode,d={38:x,40:w,39:v,37:v,13:y};d[b]&&(j.focus(),d[b](m(),a),c.onFocus&&c.onFocus.call(this,m().find("a")),c.visibleTime&&(p=setTimeout(function(){l()},c.visibleTime)))},c={delayTime:500,
    visibleTime:0,minLength:3,itemPerList:10,eventType:"keyup",appendTo:null,label:null,value:null,proxy:null,renderItem:function(a,b){var c=g("<li></li>").addClass("autocomplete-search-item"),e=g("<a></a>").appendTo(c);e.data("value",a[b.value]).data("label",a[b.label]).html(a[b.label]).bind("click",function(){j.val(a[b.value]).focus();b.onSelect&&b.onSelect.call(this,e)});return c},onSelect:function(){},onFocus:function(a){j.val(a.data("value")).focus()},onOpen:function(){},onClose:function(){}};g.extend(c,
    h);f=g(c.appendTo);j.bind(c.eventType,function(a){for(var b=0;b<n.length;b++)clearTimeout(n[b]);this.setAttribute("autocomplete","off");var d=g.trim(this.value),b=a.keyCode,d=d&&d.length;-1!=c.eventType.toLowerCase().indexOf("keydown")&&(8!=a.keyCode?d++:d--);if(d>=c.minLength){if(37<=b&&40>=b||13==b)return z(a),!1;a=setTimeout(function(){c.proxy(j.val(),function(a){if(a&&a.list){f.find("ul.autocomplete").remove();for(var b in a.list){k++;var d=a.list[b];if(d&&g.isArray(d))for(var j=g("<ul></ul>").addClass("autocomplete").addClass("list-"+
    k).appendTo(c.appendTo),h=0;h<d.length;h++)j.append(c.renderItem(d[h],c))}1<k?f.addClass("multipleList"):f.removeClass("multipleList");s()}});k=0},c.delayTime);n.push(a)}else l(),f.find("ul.autocomplete").remove()}).bind("blur",l)}})(jQuery);